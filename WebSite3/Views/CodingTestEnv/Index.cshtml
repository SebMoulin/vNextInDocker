@using WebSite3.Utils
@model WebSite3.Models.CurrentCodingTestEnvironmentViewModel

<h2>Manage existing coding test</h2>

<table class="table table-hover table-striped table-condensed">
    <thead>
        <tr>
            <th class="col-md-4">
                <label>Project</label>
            </th>
            <th class="col-md-2">
                <label>Candidate</label>
            </th>
            <th class="col-md-2">
                <label>Created at</label>
            </th>
            <th class="col-md-2 nowrap">
                <label>
                    Last Activity At
                </label>
            </th>
            <th class="col-md-2" style="white-space: nowrap">
                &nbsp;
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var testEnv in Model.Projects)
        {
            var candidate = testEnv.Members.FirstOrDefault();
            var candidateName = "Candidate Access removed";
            var candidateId = string.Empty;
            if (candidate != null)
            {
                candidateName = candidate.Name;
                candidateId = candidate.Id;
            }
            var createdAt = testEnv.CreatedAt.HasValue ? @testEnv.CreatedAt.Value.ToShortDateString() + " - " + @testEnv.CreatedAt.Value.ToShortTimeString() : string.Empty;
            var lastActivityAt = testEnv.LastActivityAt.HasValue ? @testEnv.LastActivityAt.Value.ToShortDateString() + " - " + @testEnv.LastActivityAt.Value.ToShortTimeString() : string.Empty;
            <tr>
                <td class="col-md-4">
                    <span>@testEnv.Name</span>
                </td>
                <td class="col-md-2">
                    <span>@candidateName</span>
                </td>
                <td class="col-md-2">
                    <span>@createdAt</span>
                </td>
                <td class="col-md-2">
                    <span>@lastActivityAt</span>
                </td>
                <td class="col-md-2 text-right" style="white-space: nowrap">
                    @Html.ActionLink("Evaluation form", "CandidateEvaluation", "CodingTestEnv", new { projectId = @testEnv.Id, candidateId = candidateId }, new { @class = "btn btn-xs btn-primary" })
                    @Html.ActionLink("Generate Report", "GenerateReport", "CodingTestEnv", new { projectId = @testEnv.Id, candidateId = candidateId }, new { @class = "btn btn-xs btn-primary" })
                    @Html.ActionLink("Remove Candiate Access", "RemoveUserAccess", "CodingTestEnv", new { projectId = @testEnv.Id, candidateId = candidateId }, @Html.GetRemoveUserAccessButtonStyle(@candidate != null))
                    @Html.ActionLink("Delete Test", "DeleteTestEnv", "CodingTestEnv", new { projectId = @testEnv.Id, candidateId = candidateId }, new { onclick = "return confirm('Are you sure you want to delete this test?');", @class = "btn btn-xs btn-danger" })
                </td>
            </tr>
        }
    </tbody>
</table>